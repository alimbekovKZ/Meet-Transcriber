# Спецификация плагина для транскрибации звонков в Google Meet

## 1. Описание проекта
Этот плагин для Google Chrome автоматически записывает аудиопоток во время звонков в Google Meet, отправляет его на сервер OpenAI Whisper API и сохраняет транскрибированный текст в виде `.txt`-файла.

## 2. Функциональные требования

### 2.1 Основные функции
- Автоматическая запись аудиопотока при входе в Google Meet.
- Сохранение аудиофайла в формате `.wav` с использованием `FileSystem API`.
- Отправка файла на сервер OpenAI Whisper API по завершении звонка.
- Автоматическое скачивание транскрипции в формате `.txt` после обработки.
- Генерация имени файла транскрипции на основе даты, времени и названия встречи.
- Уведомления о начале и завершении записи, а также о скачивании транскрипции.
- Возможность отключить запись через кнопку «Не записывать эту встречу» во время звонка.
- Возможность вручную остановить запись через интерфейс плагина.
- Страница настроек плагина (`chrome://extensions → «Настройки»`).

### 2.2 Ограничения и платформы
- Работает только с Google Meet.
- Обрабатывает аудиопоток всех участников.
- Whisper API используется для обработки на сервере.
- Поддерживает несколько языков автоматически.

## 3. Технические решения

### 3.1 Архитектура
- **Контентный скрипт:** Запускается на странице Google Meet, перехватывает аудиопоток.
- **Background-скрипт:** Обрабатывает данные, управляет отправкой на сервер.
- **Popup-интерфейс:** Позволяет вручную остановить запись.
- **Страница настроек:** Управление уведомлениями и форматированием имен файлов.

### 3.2 Работа с аудио
1. Перехват WebRTC-аудиопотока через `AudioContext`.
2. Запись аудио в `FileSystem API` в формате `.wav`.
3. Автоматическая отправка файла на сервер после завершения звонка.

### 3.3 API-интеграция
- Whisper API: передача `.wav`-файла, получение транскрипции.
- Использование HTTPS для передачи данных.
- Ограничение по размеру аудиофайла (например, 2 часа).

## 4. Обработка ошибок
- **Ошибка доступа к аудиопотоку:** Показывать уведомление.
- **Ошибка сети при отправке файла:** Повторная попытка отправки.
- **Ошибка обработки на сервере:** Показывать сообщение и сохранять файл локально.
- **Ошибка сохранения `.txt`-файла:** Предлагать пользователю скачать вручную.

## 5. Интерфейс пользователя
- Всплывающее уведомление при старте записи.
- Всплывающее уведомление при завершении и скачивании файла.
- Кнопка «Остановить запись» в popup-интерфейсе.
- Кнопка «Не записывать эту встречу» во время звонка.
- Страница настроек с возможностью включения/выключения уведомлений и управления именами файлов.

## 6. План тестирования

### 6.1 Функциональные тесты
- Автоматический старт записи при входе в Google Meet.
- Корректное сохранение `.wav`-файла в `FileSystem API`.
- Успешная отправка аудио на сервер Whisper API.
- Корректное скачивание `.txt`-файла.

### 6.2 UI-тесты
- Работа popup-интерфейса и кнопки «Остановить запись».
- Уведомления работают корректно.

### 6.3 Ошибки и восстановление
- Проверка работы при медленном интернете.
- Повторные попытки отправки при сбое сети.
- Корректное поведение при закрытии вкладки во время записи.

---
**Документ подготовлен для передачи разработчику.**